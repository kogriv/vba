Скрипт на vba для поиска всех книг эксель в папке c:\data\
открытия их и копирования данных с первых листов в отдельную книгу (объединения всех данных)

Этот скрипт будет искать все файлы Excel в папке C:\data\, открывать каждый из них, копировать данные с первого листа и вставлять их в новый рабочий лист в текущей книге Excel. Пожалуйста, убедитесь, что у вас есть разрешения на чтение файлов из этой папки и на запись в текущую книгу Excel.

```vba
Sub ОбъединитьДанныеИзКниг()
    Dim папкаДляПоиска As String
    Dim имяФайла As String
    Dim книгаИсточник As Workbook
    Dim первыйЛистИсточника As Worksheet
    Dim книгаНазначения As Workbook
    Dim листНазначения As Worksheet
    Dim следующаяСвободнаяСтрока As Long

    ' Путь к папке
    папкаДляПоиска = "C:\data\"
    имяФайла = Dir(папкаДляПоиска & "*.xls*")

    ' Текущая книга и лист для вставки данных
    Set книгаНазначения = ThisWorkbook
    Set листНазначения = книгаНазначения.Sheets(1)
    следующаяСвободнаяСтрока = 1

    ' Перебор всех файлов Excel в папке
    Do While имяФайла <> ""
        Set книгаИсточник = Workbooks.Open(папкаДляПоиска & имяФайла)
        Set первыйЛистИсточника = книгаИсточник.Sheets(1)

        ' Копирование данных с первого листа
        первыйЛистИсточника.UsedRange.Copy листНазначения.Cells(следующаяСвободнаяСтрока, 1)

        ' Обновление номера следующей свободной строки
        следующаяСвободнаяСтрока = листНазначения.Cells(листНазначения.Rows.Count, 1).End(xlUp).Row + 1

        ' Закрытие книги без сохранения изменений
        книгаИсточник.Close SaveChanges:=False

        ' Следующий файл
        имяФайла = Dir()
    Loop

    MsgBox "Объединение данных завершено."
End Sub
```

Этот скрипт следует запустить из VBA-редактора в Excel. Для этого:

Откройте Excel и перейдите во вкладку "Разработчик" (Developer). Если она не отображается, включите её через параметры Excel.
Нажмите на кнопку "Visual Basic", чтобы открыть редактор VBA.
Вставьте скрипт в модуль листа или создайте новый модуль для этого скрипта.
Запустите скрипт, нажав F5 или выбрав соответствующую команду в меню.
Убедитесь, что у вас включены разрешения на выполнение макросов в Excel.