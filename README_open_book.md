## Программа редактор. Настройка вида.
В работе использовалась программа MS Visual Basic for Application 7.1.  
Используйте меню `Tools -> Options`вкладка `Editor Format` для настройке цветов отображения и размера текста.
Берегите зрение! Обязательно делайте перерывы! Будьте счастливы! Повторяйте!

## Сохранение модулей
При первом сохранении модулей VBA (файлов Эксель с модулями ВБА) потребуется выбор тапа файла - с поддержкой макросов (*.xlsm). Должно появиться соответсвующее диалоговое окно.

## Отладочная информация
Используйте консоль редактора `Immediate Window` (Ctrl+G).  
Используйте команды `Debug.Print "Some message"` для вывода необходимой информации в консоль.  
Возможна пошаговое выполнение. Для этого установите точки останова одинарным нажатием левой кнопки мыши по левой кромке окна модуля с кодом напротив нужной строки.

## Пошаговая инструкция. Hello, world
- Открытие Excel и редактора VBA:  
Запустите Microsoft Excel.
Нажмите `ALT + F11`, чтобы открыть редактор VBA.

- Создание нового модуля:
В редакторе VBA, выберите в меню "Вставка" (Insert) -> "Модуль" (Module).

В окне модуля напишите следующий код:
```vba
Sub HelloWorld()
    MsgBox "Hello, world!"
End Sub
```
- Запуск макроса в редакторе VBA:  
Нажмите `F5`, либо кнопку с изображением зеленого треугольника (play) на панели инструментов.

- Запуск макроса в книге Эксель:  
Закройте редактор VBA. Перейдите в Эксель `ALT + F11`.  
Нажмите `ALT + F8`, чтобы открыть диалоговое окно `"Макрос"`.
Выберите `"HelloWorld"` (или как вы назвали ваш макрос) из списка и нажмите "Выполнить" (Run).

Вы увидите всплывающее окно с сообщением `"Hello, world!"`.

Этот код создает макрос (подпрограмму) с именем HelloWorld, который выводит сообщение с использованием функции MsgBox. Вы можете изменить код согласно вашим потребностям.

Если вы хотите создать новую книгу и вывести сообщение:
```vba
Sub HelloWorldInNewWorkbook()
    Dim newWorkbook As Workbook
    Set newWorkbook = Workbooks.Add
    MsgBox "Hello, world! This is in a new workbook."
End Sub
```

## Структура проектов
В Visual Basic for Applications (VBA) для Excel структура проекта может быть организована следующим образом:  
**MS Excel Objects:**
Эта папка содержит объекты, связанные с листами Excel, книгами и приложением в целом.  
Примеры объектов: `Workbook`/`ThisWorkbook`/`ЭтаКнига` (книга), `Worksheet`/`Лист1 (Sheet1)` (лист), `Chart` (диаграмма) и т.д.
Здесь вы можете размещать код, который будет выполняться при событиях, связанных с этими объектами (например, событие открытия книги, изменения на листе и т.д.).

**Forms:**
Здесь содержатся пользовательские формы, созданные для взаимодействия с пользователем.  
Формы предоставляют удобный способ создания интерфейса с элементами управления (кнопки, текстовые поля, списки и т.д.).  
Код в этой папке обрабатывает события, происходящие на формах, такие как нажатие кнопок или изменение значений полей.

**Modules:**
В этой папке размещаются общие процедуры и функции, которые могут быть вызваны из других частей проекта.  
Modules предоставляют пространство для организации кода и избегания дублирования.  
Код в модулях может содержать процедуры, обработчики событий, константы и переменные.

**Class Modules:**
Class Modules используются для создания объектно-ориентированного программирования (ООП) в VBA.  
Они позволяют создавать пользовательские объекты с своими методами и свойствами.  
Классы полезны, например, когда требуется работать с несколькими экземплярами одного и того же типа объекта.

## Ограничения VBA
- Однопоточность:
VBA работает в однопоточном режиме, что означает, что он выполняет код последовательно. Это может вызвать блокировки, если какой-то код выполняется слишком долго.

- Ограниченные возможности ООП:
Хотя VBA поддерживает объектно-ориентированное программирование, его возможности в этой области ограничены по сравнению с более современными языками.

- Ограниченные средства отладки:
Средства отладки в VBA не так развиты, как в некоторых других средах программирования.

- Ограниченная поддержка современных технологий:
VBA был создан давно, и у него есть ограниченная поддержка современных технологий и стандартов.

- Ограниченный объем памяти:
При работе с большими объемами данных может возникнуть ограничение по доступной памяти.

Несмотря на эти ограничения, VBA остается мощным инструментом для автоматизации задач в Excel и других приложениях Microsoft Office.

## Элементы MS Excel Objects: Workbook, Worksheet..
В VBA для Excel, элементы MS Excel Objects представляют собой объекты, связанные с книгами, листами, диаграммами и другими частями Excel. Вот более подробное описание нескольких из них:

- **Workbook (Книга)**:
Workbook представляет собой объект, связанный с рабочей книгой Excel.
В папке MS Excel Objects вы можете создавать процедуры, которые будут выполняться при различных событиях, связанных с книгой, таких как открытие, закрытие, изменение и т.д.

- **Worksheet (Лист)**:
Worksheet представляет собой объект, связанный с листом в книге Excel.
В этой папке можно размещать код, который будет выполняться при событиях, связанных с листом, таких как изменение ячейки, выбор новой ячейки и т.д.

- **Chart (Диаграмма)**:
Chart представляет собой объект, связанный с диаграммой в Excel.
В папке MS Excel Objects можно создавать код, который будет автоматически выполняться при событиях, связанных с диаграммой.

- **PivotTable (Сводная таблица)**:
PivotTable объект связан с сводной таблицей в Excel.
В папке MS Excel Objects можно создавать процедуры для обработки событий, связанных со сводной таблицей.

- **ChartSheet (Лист диаграммы)**:
ChartSheet объект представляет собой лист, на котором отображается только диаграмма, без таблицы данных.
Также поддерживает события, которые можно обрабатывать в папке MS Excel Objects.

- **QueryTable (Запрос к внешней таблице)**:
QueryTable объект используется для работы с данными, полученными из внешних источников с использованием запросов (например, из базы данных или веб-сервиса).
Может быть использован для обработки событий, связанных с обновлением данных.

- **OLEObject (Объект OLE)**:
OLEObject объект представляет собой встроенный объект OLE (Object Linking and Embedding), такой как графика или документ Microsoft Word.
В папке MS Excel Objects можно создавать процедуры для обработки событий, связанных с встроенными объектами.

- **QueryTable (Запрос к внешней таблице)**:
QueryTable объект используется для работы с данными, полученными из внешних источников с использованием запросов (например, из базы данных или веб-сервиса).  
Может быть использован для обработки событий, связанных с обновлением данных.

## Появление элементов в MS Excel Objects
Элементы в папке "MS Excel Objects" будут автоматически появляться, когда вы создаете новые объекты в рамках вашей книги Excel. Например, если вы создадите новую диаграмму (Chart), соответствующий объект ChartSheet появится в папке "MS Excel Objects". Давайте рассмотрим пример:

Откройте Excel и создайте новую книгу.

Вставьте новую диаграмму на лист (например, нажмите Alt + F1 после выделения диапазона данных).

Перейдите в редактор VBA, нажав Alt + F11.

В окне "Project Explorer" найдите вашу книгу (`ThisWorkbook` / `ЭтаКнига`) и разверните папку "MS Excel Objects".

Вы увидите объекты, такие как `"Лист" (Sheet)` и `"Книга"` (`ThisWorkbook`). Они автоматически создаются при создании новой книги.

Теперь вернитесь в Excel и создайте новую диаграмму (например, столбчатую диаграмму) **НА ОТДЕЛЬНОМ ЛИСТЕ**.

Вернитесь в редактор VBA, и теперь вы должны увидеть новый объект `"Диаграмма" (Chart)` в папке `"MS Excel Objects"`.

Вы можете дважды щелкнуть на объекте `"Диаграмма"`, чтобы открыть окно кода и добавить процедуры обработки событий, связанных с этой диаграммой.

Процедуры обработки событий для диаграммы могут включать, например, `Chart_Activate`, `Chart_Deactivate`, `Chart_Select`, и так далее, в зависимости от вашего взаимодействия с диаграммой.

## Другие элементы MS Excel Objects (ThisWorkbook, Application..)
В папке "MS Excel Objects" также могут содержаться элементы, связанные с событиями на уровне самого приложения Excel. Некоторые из них включают:

**ThisWorkbook:**  
ThisWorkbook представляет собой объект, связанный с текущей книгой (рабочей книгой, в которой находится код).  
В этой папке можно размещать процедуры, которые будут выполняться при событиях, связанных с самой книгой, таких как открытие или закрытие книги.

**Application:**  
Application представляет собой объект, связанный с самим приложением Excel.
В этой папке можно размещать процедуры, которые будут выполняться при событиях, связанных с самим приложением, например, при запуске или закрытии Excel.

**WorkbookEvents:**  
Этот элемент может содержать процедуры, связанные с событиями, происходящими в любой книге Excel, включая открытие, закрытие, изменение и т.д.

**WorksheetEvents:**  
Аналогично предыдущему, этот элемент содержит процедуры, связанные с событиями на любом листе Excel.

Эти элементы позволяют более детально настраивать обработку событий на уровне приложения и книги, что может быть полезным при создании сложных макросов и пользовательских приложений.

## Примеры типичных процедур для объекта ThisWorkbook
Процедуры, размещаемые в объекте ThisWorkbook, будут выполняться при определенных событиях, связанных с самой книгой (рабочей книгой, в которой находится код). Вот несколько примеров типичных процедур для объекта ThisWorkbook:

**Workbook_Open:**  
Процедура, которая будет выполнена при открытии книги. Может использоваться, например, для автоматического выполнения каких-то действий при открытии книги.
```vba
Private Sub Workbook_Open()
    MsgBox "Добро пожаловать в эту книгу!"
End Sub
```

**Workbook_BeforeClose:**  
Процедура, выполняемая перед закрытием книги. Может быть использована для подтверждения закрытия или сохранения изменений.
```vba
Private Sub Workbook_BeforeClose(Cancel As Boolean)
    If MsgBox("Вы уверены, что хотите закрыть книгу?", vbYesNo) = vbNo Then
        Cancel = True
    End If
End Sub
```

**Workbook_SheetChange:**  
Процедура, выполняемая при изменении любого листа в книге. Может быть использована для отслеживания изменений данных.
```vba
Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)
    MsgBox "Данные были изменены на листе: " & Sh.Name
End Sub
```

**Workbook_BeforeSave:**  
Процедура, выполняемая перед сохранением книги. Может использоваться для выполнения дополнительных действий перед сохранением.
```vba
Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
    MsgBox "Сохранение книги начато."
End Sub
```

**Workbook_AfterSave:**  
Процедура, выполняемая после успешного сохранения книги. Может быть использована для вывода сообщения об успешном сохранении.
```vba
Private Sub Workbook_AfterSave(ByVal Success As Boolean)
    If Success Then
        MsgBox "Книга успешно сохранена."
    Else
        MsgBox "Произошла ошибка при сохранении книги."
    End If
End Sub
```

Эти процедуры представляют лишь малую часть возможных сценариев использования. В зависимости от потребностей проекта и требуемого функционала, можно создавать более сложные обработчики событий в объекте ThisWorkbook.

## Имена процедур объектов (например Workbook_Open())
Имена этих процедур являются частью системы событий VBA и Excel. Они не являются зарезервированными словами в строгом смысле, но их использование соответствует определенным соглашениям именования, которые Excel распознает как обработчики событий.

Названия процедур событий (event procedures) в VBA следуют следующему шаблону: `ObjectName_EventName`. В данном случае `ObjectName` - это имя объекта, а `EventName` - это событие, на которое вы хотите повесить обработчик.

Например, для объекта `ThisWorkbook` и события открытия (`Open`), имя процедуры будет `Workbook_Open`.

Когда Excel открывает книгу и обнаруживает процедуру с именем `Workbook_Open`, он автоматически выполняет эту процедуру. Таким образом, Excel заранее знает, что при наступлении определенного события (в данном случае, открытия книги) должна быть выполнена соответствующая процедура.

Если вы хотите узнать, какие события поддерживаются объектами, вы можете использовать редактор VBA в Excel. Перейдите в `Object Browser (F2)`, выберите объект в столбце `Classes` (например, `Workbook`), а затем в столбце `Members of 'Workbook` вы увидите список элементов, в т.ч. событий (отмечены значком "молния"), которые можно обработать для данного объекта.

## Именование элементов (модулей и процедур)
Для корректного использования процедур расположенных в модулях, напрмер, при отображении списка процедур в списке макросов Книги (Alt + F8), следует давать уникальные названия для всех элементов (и для процедур и для модулей).  

## Назначение горячих клавиш на макрос/процедуру
Находясь в книге Excel.  
Выберите вкладку "Разработчик". Если у вас ее нет, включите ее в настройках Excel.  
Нажмите "Макросы" в разделе "Разработчик".  
В открывшемся окне выберите ваш макрос (ваша процедура, например, "ShowMyForm").  
Нажмите "Параметры" и укажите желаемое сочетание клавиш в поле "Клавиши".

## Файл эксель и привязанные к нему модули
Файл Excel содержит в себе все модули и макросы, которые вы создали внутри этого файла, и они сохраняются вместе с файлом. Когда вы переносите файл-хозяин (например, файл Excel с макросами) в другую папку или на другой компьютер, все связанные с ним модули и макросы также будут перенесены.

Однако же, если вы экспортируете отдельный модуль в виде файла `.bas` и затем переносите этот файл, то он становится отдельным файлом, и его нужно импортировать обратно в проект VBA, чтобы он стал частью файла-хозяина.

В контексте управления версиями, такого как Git, обычно рекомендуется коммитить (вносить изменения и сохранять) сам файл-хозяин (например, `environ_vars_complect.xlsm`). Это позволяет отслеживать все изменения в вашем проекте, включая все модули, макросы и другие объекты VBA, находящиеся внутри этого файла.

Если у вас есть несколько файлов, связанных с проектом (например, Excel-файл и файлы данных), то также важно убедиться, что все необходимые файлы добавлены в систему контроля версий. Вам необходимо управлять всеми файлами, которые влияют на состояние вашего проекта.

## Выполнение программ в вба. Точки возврата
В VBA программы выполняются сверху вниз, но при этом исполнение кода прерывается после выполнения подпрограммы (`Sub`) или функции (`Function`), и управление возвращается туда, откуда была вызвана подпрограмма или функция.  

В VBA термин **"точка возврата"** обычно относится к строке кода, где был вызван определенный подпрограммный блок (`Sub` или `Function`). Давайте разберемся с терминологией и подробнее:

**Имя Подпрограммы (Sub или Function):** В момент вызова подпрограммы в коде, управление передается в тело этой подпрограммы. Точка, где был сделан вызов, становится "точкой возврата" для этой подпрограммы.

Пример:
```vba
Sub MainSub()
    ' Какой-то код...
    AnotherSub ' <-- Точка возврата для AnotherSub
    ' Этот код будет выполнен после AnotherSub()
End Sub

Sub AnotherSub()
    ' Ваш код...
End Sub
```

**Стек Вызовов (Call Stack):** Во время выполнения кода VBA создает стек вызовов, который представляет собой структуру данных, хранящую информацию о вызванных подпрограммах и их текущем состоянии. Каждый раз, когда вызывается новая подпрограмма, ее контекст (состояние) добавляется в верхнюю часть стека. Когда подпрограмма завершает выполнение, ее контекст удаляется из стека, и управление передается обратно к той подпрограмме, которая вызвала ее.

Например:
```vba
Sub MainSub()
    ' Какой-то код...
    AnotherSub ' <-- AnotherSub добавляется на вершину стека
    ' Этот код будет выполнен после AnotherSub()
End Sub

Sub AnotherSub()
    ' Ваш код...
End Sub
```

В данном случае, стек вызовов будет содержать информацию о `MainSub` и `AnotherSub`. Когда AnotherSub завершает выполнение, его контекст удаляется из стека, и управление возвращается к MainSub.

**Окно выполнения (Execution Window):** Во время отладки кода в среде разработки VBA (например, в Excel), вы можете использовать окно выполнения (`Execution Window`), чтобы отслеживать точки возврата и текущее состояние стека вызовов. Вы можете открыть окно выполнения, выбрав "View" > `"Immediate Window"` в меню, а затем вводя `?` или `Debug.Print` имена подпрограмм для отображения текущего стека вызовов.

Пример:
```vba
Sub MainSub()
    ' Какой-то код...
    AnotherSub ' <-- AnotherSub добавляется на вершину стека
    ' Этот код будет выполнен после AnotherSub()
End Sub

Sub AnotherSub()
    ' Ваш код...
    Debug.Print "Точка возврата: " & Application.Caller
End Sub
```

В этом примере `Application.Caller` может использоваться в окне выполнения для отслеживания точек возврата.

## Самая первая процедура Sub...End Sub в модуле
В VBA самая первая процедура Sub в модуле (обычно это Sub Main()) является точкой входа или началом выполнения кода. Это место, откуда начинается выполнение программы. В этом контексте точкой возврата для MainSub() будет место, где завершится выполнение всего кода в модуле, и программа завершит свою работу.

Т.е. самый первый в коде комплект инструкций `Sub Some_Function() ... End Sub` будет являтся также и последним в смысле фокуса выполнения. Т.е., если после такой, удущей первой в коде конструкции `Sub Some_Function() ... End Sub` далее ниже по коду будет еще какой то комплект `Sub Another_Function() ... End Sub` и такая `Another_Function()` не будет вызвана внутри идущей первой в коде `Some_Function()`, то `Another_Function()` вообще не будет вызвана.

Пример:
```vba
Sub Main()
    Debug.Print "*******************"
    Debug.Print "Main Inception"
    Debug.Print "first calling"
    first
    'Debug.Print "second calling"
    'second
    Debug.Print "*******************"
End Sub

Sub first()
    Debug.Print "first inception"
    Debug.Print "first"
End Sub

Sub second()
    Debug.Print "second inception"
    Debug.Print "second"
End Sub
```
вывод:
```cmd
*******************
Main Inception
first calling
first inception
first
*******************
```
Процедура second(), объявленная ниже в коде и не вызванная в начальной процедуре Main(), вообще игнорируется - не используется в программе.

В VBA, `точка возврата` для главной процедуры (в данном случае Main()) будет точкой, где выполнение программы завершится. Таким образом, после выполнения Main() управление не возвращается внутрь Main(), а программа завершает свою работу.

## Установка задержки выполнения программы
`Application.Wait` используется для добавления временной задержки в выполнении программы. Это может быть полезно, например, для того чтобы дать пользователю время на взаимодействие с интерфейсом программы, прежде чем программа продолжит свое выполнение.

Синтаксис `Application.Wait` следующий:
```vba
Sub Main()
    Debug.Print "*******************"
    Debug.Print "Main Inception"
    Debug.Print "first calling"
    first
    Debug.Print "second calling"
    second
    Debug.Print "*******************"
    
    ' Добавляем задержку в 5 секунд
    Application.Wait (Now + TimeValue("0:00:05"))
    
    ' Дополнительный код после Main(), который выполнится после задержки
    Debug.Print "Additional code after Main()"
End Sub

Sub first()
    Debug.Print "first inception"
    Debug.Print "first"
End Sub

Sub second()
    Debug.Print "second inception"
    Debug.Print "second"
End Sub
```
В этом примере, после завершения выполнения Main(), программа будет ожидать 5 секунд, прежде чем выполнится дополнительный код.

## Информация о файле- хозяине запускаемого модуля
VBA можно использовать объект ThisWorkbook для получения информации о файле-хозяине. ThisWorkbook представляет книгу Excel, в которой выполняется текущий код VBA. Вы можете получить имя файла с использованием свойства FullName у объекта ThisWorkbook. Вот пример:
```vba
Sub ПолучитьИмяФайла()
    Dim имяФайла As String
    имяФайла = ThisWorkbook.FullName
    
    If Len(имяФайла) > 0 Then
        Debug.Print "Имя файла-хозяина: " & имяФайла
    Else
        Debug.Print "Не удалось получить имя файла."
    End If
End Sub
```

В VBA, когда вы экспортируете модуль через меню (например, через "Экспорт файлов проекта" в редакторе VBA), сохраненный файл `*.bas` является отдельным текстовым файлом, который содержит код из соответствующего модуля. Этот файл обычно сохраняется в той же папке, где расположен файл-хозяин. В вашем случае, если вы экспортировали `Module2`, то файл `Module2.bas` должен быть в той же директории, что и ваш файл `******.xlsm`.

Этот файл `.bas` - это текстовый файл, и его можно просматривать в любом текстовом редакторе. Вы можете открыть его, чтобы посмотреть код модуля, и вам не нужно экспортировать его, чтобы просмотреть содержимое.

Если вам нужно найти расположение этого файла программно из кода VBA, это сложнее сделать. В VBA нет стандартных функций для получения полного пути к файлу модуля, который выполняется. Обычно такие вопросы об управлении файлами лучше решать вне самого VBA, например, с использованием языков программирования, таких как Python, которые предоставляют более широкие возможности для работы с файловой системой.

## Классы в VBA
в VBA есть возможность создавать классы и работать с объектами. Это называется "User-Defined Types" (определение типов пользователей) или просто "Classes" (классы).

Вот пример создания класса в VBA:  
В VBA редакторе, выберите "Вставка" -> "Класс модуля" (Insert -> Class Module). В окне кода появится новый модуль с именем "Class1" (или что-то подобное).

Пример кода для вашего нового класса:
```vba
' В Class1
Public Имя As String
Public Возраст As Integer

' Пример метода класса
Public Function ВывестиИнформацию() As String
    ВывестиИнформацию = "Имя: " & Имя & ", Возраст: " & Возраст
End Function
```

Теперь вы можете создать объект этого класса в другом модуле и использовать его:
```vba
Sub ТестКласса()
    ' Создание объекта класса
    Dim МойОбъект As New Class1
    
    ' Установка значений свойств
    МойОбъект.Имя = "John"
    МойОбъект.Возраст = 30
    
    ' Вызов метода класса
    MsgBox МойОбъект.ВывестиИнформацию
End Sub
```

Этот пример создает класс Class1 с двумя свойствами (Имя и Возраст) и методом (ВывестиИнформацию). Затем в другом модуле создается объект этого класса, устанавливаются значения свойств и вызывается метод для отображения информации.

## Пример создания простой формы с кнопкой
Находимся в редакторе VBA. В проводнике проектов должен быть раскрыт ваш текущий проект, в моем случае это `VBAProject (environ_vars_complect.xlsm)`  
**Создадим форму:**  
Пр.кнопка мыши на папку `Forms` -> `Insert` -> `UserForm`. Создастся форма с именем, напрмер, `UserForm1`. Появится макет пустой формы. Также появится окошко разных объектов (элементов управления), которые можно накидывать на форму. Пока ничего не добавляем.     
Переименуем форму: выведим элемент `UserForm1` одинарным нажатием л.кнопки мыши в проводнике проектов, нажмем `F4` (Menu: `View` -> `Properties Window`). Внизу будет окно свойств для данного элемента в виде таблицы (смотрим вкладку Alphabetic). Находим строку `(Name)`и напротив нее в ячейке меняем название на (в моем случае) `StartFormClass`.  

У форм есть два режима просмотра: `View Code` и `View Object`. Они выбираются либо в меню при нажатии пр.кнопки по элементу формы в проводнике, либо после выбора формы впроводнике одинарным нажатием л.кнопки в меню `View`

`View Object` - графический режим. Поменяем в нем заголовок формы на `StartForm_head`. Для этого в свойствах (F4) находим и меняем значение для `Caption`.  
Также добавим на форму кнопку (объект `CommandButton` из `Controls`). Кнопка сохранится с именем `CommandButton1`. Оставим его. Перейдем в режим кода.  
`View Code` - режим кодирования. Там уже будет код по умолчанию. Добавим команду для вывода сообщения при нажатии кнопки.
```vba
Private Sub CommandButton1_Click()
    MsgBox "Здесь может быть ВАША РЕКЛАМА :-p" 'Здесь может быть любой код
End Sub

Private Sub UserForm_Click()

End Sub
```

**Создадим класс** и переименуем его в `StartFormClass`. Код в классе будем использовать в разных местах. Код в модуле класса:
```vba
Public Function RunStartForm()
    StartForm.Show
End Function
```
Единственная процедура класса вызывает к жизни созданную нами ранее форму.

**Создадим модуль** и переименуем его в `StartForm_module`. Код в модуле:
```vba
Sub StartFormFunction()
    Debug.Print "--====--"
    Dim MyStartForm As New StartFormClass
     
    MyStartForm.RunStartForm
End Sub
```
`Debug.Print "--====--"` - отладочная информация в онсоль.  
`Dim MyStartForm As New StartFormClass` - создание объекта `MyStartForm` как экземпляра класса `StartFormClass`. В данном случае мы можем через точку вызывать процедуры класса: `MyStartForm.RunStartForm`.  
На этом этапе уже можно вызвать форму по нажатию F5 в модуле `StartForm_module`. Рекомендуется также добавить горячюю клавишу на данную процедуру модуля `StartFormFunction()`. Для этого в книге эксель откройте список макросов (Alt+F8), найдите StartFormFunction, перейдите в параметры и установите нужные клавиши (я добавил просто j, можно использовать шифт). Теперь данную форму можно вызвать нажатием клавиш.

**Установим автостарт** формы при запуске файла. Откроем модуль `ЭтаКнига` или `ThisBook` в папке MS Excel Objects. Этот модуль отвечает за данную книгу. Код в модуле:
```vba
Private Sub Workbook_Open()
    StartForm.Show
End Sub
```

Теперь вы можете создавая классы со своим нужным поведением устанавливать любые комплексы процедур на нажатие кнопки. Или (и) использовать другие объеты управления в форме.

## Пример работы с файлами
Скрипт на vba для поиска всех книг эксель в папке c:\data\
открытия их и копирования данных с первых листов в отдельную книгу (объединения всех данных)

Этот скрипт будет искать все файлы Excel в папке C:\data\, открывать каждый из них, копировать данные с первого листа и вставлять их в новый рабочий лист в текущей книге Excel. Пожалуйста, убедитесь, что у вас есть разрешения на чтение файлов из этой папки и на запись в текущую книгу Excel.

```vba
Sub ОбъединитьДанныеИзКниг()
    Dim папкаДляПоиска As String
    Dim имяФайла As String
    Dim книгаИсточник As Workbook
    Dim первыйЛистИсточника As Worksheet
    Dim книгаНазначения As Workbook
    Dim листНазначения As Worksheet
    Dim следующаяСвободнаяСтрока As Long

    ' Путь к папке
    папкаДляПоиска = "C:\data\"
    имяФайла = Dir(папкаДляПоиска & "*.xls*")

    ' Текущая книга и лист для вставки данных
    Set книгаНазначения = ThisWorkbook
    Set листНазначения = книгаНазначения.Sheets(1)
    следующаяСвободнаяСтрока = 1

    ' Перебор всех файлов Excel в папке
    Do While имяФайла <> ""
        Set книгаИсточник = Workbooks.Open(папкаДляПоиска & имяФайла)
        Set первыйЛистИсточника = книгаИсточник.Sheets(1)

        ' Копирование данных с первого листа
        первыйЛистИсточника.UsedRange.Copy листНазначения.Cells(следующаяСвободнаяСтрока, 1)

        ' Обновление номера следующей свободной строки
        следующаяСвободнаяСтрока = листНазначения.Cells(листНазначения.Rows.Count, 1).End(xlUp).Row + 1

        ' Закрытие книги без сохранения изменений
        книгаИсточник.Close SaveChanges:=False

        ' Следующий файл
        имяФайла = Dir()
    Loop

    MsgBox "Объединение данных завершено."
End Sub
```

